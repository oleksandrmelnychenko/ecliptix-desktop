<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Ecliptix.AutoUpdater.ViewModels"
             x:Class="Ecliptix.AutoUpdater.Views.UpdateNotificationBanner"
             x:DataType="vm:UpdateViewModel">

    <Design.DataContext>
        <vm:UpdateViewModel/>
    </Design.DataContext>

    <!-- Update notification banner -->
    <Border Background="#FFF3CD"
            BorderBrush="#FFE5A3"
            BorderThickness="0,0,0,1"
            Padding="12,8"
            IsVisible="{Binding IsUpdateAvailable}">

        <Grid ColumnDefinitions="Auto,*,Auto,Auto">

            <!-- Icon -->
            <Border Grid.Column="0"
                    Width="32"
                    Height="32"
                    Background="#FFC107"
                    CornerRadius="16"
                    Margin="0,0,12,0">
                <TextBlock Text="ðŸ””"
                          FontSize="18"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </Border>

            <!-- Message -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock FontWeight="SemiBold"
                          IsVisible="{Binding !IsCriticalUpdate}">
                    <Run Text="Update available:"/>
                    <Run Text="{Binding LatestVersion}" FontWeight="Bold"/>
                </TextBlock>

                <TextBlock Text="Critical update required!"
                          FontWeight="Bold"
                          Foreground="#D32F2F"
                          IsVisible="{Binding IsCriticalUpdate}"/>

                <TextBlock Text="{Binding StatusMessage}"
                          FontSize="12"
                          Foreground="#666"
                          IsVisible="{Binding StatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
            </StackPanel>

            <!-- Progress bar (when downloading) -->
            <ProgressBar Grid.Column="2"
                        Width="150"
                        Height="6"
                        Margin="12,0"
                        Value="{Binding DownloadProgress}"
                        IsVisible="{Binding IsDownloading}"
                        VerticalAlignment="Center"/>

            <!-- Actions -->
            <StackPanel Grid.Column="3"
                       Orientation="Horizontal"
                       Spacing="8"
                       VerticalAlignment="Center">

                <Button Content="Update Now"
                       Command="{Binding InstallUpdateCommand}"
                       IsVisible="{Binding !IsDownloading}"
                       Classes="accent"/>

                <Button Content="View Details"
                       Command="{Binding ViewReleaseNotesCommand}"
                       IsVisible="{Binding !IsDownloading}"/>

                <Button Content="Ã—"
                       Command="{Binding DismissUpdateCommand}"
                       Width="32"
                       IsVisible="{Binding !IsCriticalUpdate}"/>

            </StackPanel>

        </Grid>

    </Border>

</UserControl>
