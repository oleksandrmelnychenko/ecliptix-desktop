<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:core="clr-namespace:Ecliptix.Core.Core.Controls"
        xmlns:comp="clr-namespace:Ecliptix.Core.Views.Memberships.Components"
        xmlns:coreControls="clr-namespace:Ecliptix.Core.Controls.Core"
        xmlns:controls="clr-namespace:Ecliptix.Core.Controls.Modals.BottomSheetModal"
        xmlns:vm="clr-namespace:Ecliptix.Core.ViewModels.Core"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="Ecliptix.Core.Views.Core.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="{Binding WindowTitle}"
        Width="{Binding WindowWidth}"
        Height="{Binding WindowHeight}"
        CanResize="{Binding CanResize}"
        WindowStartupLocation="CenterScreen"
        ExtendClientAreaToDecorationsHint="False"
        SystemDecorations="None"
        TransparencyLevelHint="Transparent"
        Background="Transparent"
        Icon="avares://Ecliptix.Core/Assets/Branding/Logos/logo_256x256.png">

    <Grid x:Name="MainContentGrid" ClipToBounds="True">
        <!-- 1. Animated Blur Background -->
        <Border Classes="animated-background"
                Background="{DynamicResource BlurBackgroundBrush}"
                CornerRadius="{StaticResource WindowBorderRadius}"
                Margin="12">
            <Border.Effect>
                <BlurEffect Radius="{StaticResource Blur.Radius}" />
            </Border.Effect>
        </Border>

        <!-- 2. TitleBar - Window Controls (ZIndex=5) -->
        <comp:TitleBar
            VerticalAlignment="Top"
            ZIndex="5"
            DisableMinimizeButton="False"
            DisableCloseButton="False"
            Margin="8" />

        <!-- 3. LanguageSelector - Top Right (ZIndex=100) -->
        <Border x:Name="LanguageSelectorContainer"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Margin="0,16,16,0"
                ZIndex="100"
                Background="Transparent"
                Padding="0" />

        <!-- 4. BottomSheet - Modal Overlay (ZIndex=1000) -->
        <Border
            Margin="8"
            CornerRadius="12"
            ClipToBounds="True"
            ZIndex="1000"
            x:Name="BottomSheetContainer">
            <controls:BottomSheetControl
                x:Name="BottomSheetControl"
                ZIndex="1000"
                VerticalAlignment="Stretch"
                HorizontalAlignment="Stretch"
                DismissableScrimColor="DarkGray"
                UnDismissableScrimColor="Black"
                IsDismissableOnScrimClick="True" />
        </Border>

        <!-- 5. NetworkStatusNotification - Top Center (ZIndex=1001) -->
        <coreControls:ConnectivityNotificationView
            x:Name="NetworkNotification"
            HorizontalAlignment="Center"
            VerticalAlignment="Top"
            Margin="0,50,0,0"
            FontSize="12"
            Width="320"
            Height="70"
            ZIndex="1001"
            DataContext="{Binding ConnectivityNotification}" />

        <!-- 6. MainBorder - Window Frame (contains module content) -->
        <Border Background="{DynamicResource Window.Background}"
                BorderBrush="{DynamicResource Window.Border}"
                BorderThickness="1"
                CornerRadius="{StaticResource WindowBorderRadius}"
                Margin="8"
                ClipToBounds="True"
                x:Name="MainBorder">

            <Border.Effect>
                <DropShadowEffect Color="Black"
                                  BlurRadius="{StaticResource Shadow.Radius}"
                                  Opacity="0.1"
                                  OffsetX="0"
                                  OffsetY="2" />
            </Border.Effect>

            <!-- Module Content Area -->
            <core:ModuleContentControl ViewModelContent="{Binding CurrentContent}"
                                       Background="Transparent"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch" />
        </Border>
    </Grid>
</Window>
