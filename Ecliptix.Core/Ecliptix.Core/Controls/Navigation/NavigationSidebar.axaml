<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Ecliptix.Core.ViewModels.Navigation"
             xmlns:models="clr-namespace:Ecliptix.Core.Models.Navigation"
             mc:Ignorable="d"
             d:DesignWidth="60"
             d:DesignHeight="600"
             x:DataType="vm:NavigationSidebarViewModel"
             x:Class="Ecliptix.Core.Controls.Navigation.NavigationSidebar">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceInclude Source="/Assets/Icons/Navigation/HomeIcon.axaml" />
                <ResourceInclude Source="/Assets/Icons/Navigation/ChatsIcon.axaml" />
                <ResourceInclude Source="/Assets/Icons/Navigation/SettingsIcon.axaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <UserControl.Styles>
        <Style Selector="Button.nav-button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Width" Value="48" />
            <Setter Property="Height" Value="48" />
            <Setter Property="Margin" Value="6,4" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <Style Selector="Button.nav-button:pointerover">
            <Setter Property="Background" Value="#3A3A3A" />
        </Style>

        <Style Selector="Button.nav-button:pressed">
            <Setter Property="Background" Value="#4A4A4A" />
        </Style>

        <Style Selector="Button.nav-button.selected">
            <Setter Property="Background" Value="#434343" />
        </Style>

        <Style Selector="Button.nav-button.selected:pointerover">
            <Setter Property="Background" Value="#4E4E4E" />
        </Style>

        <Style Selector="Button.nav-button.selected:pressed">
            <Setter Property="Background" Value="#525252" />
        </Style>

        <Style Selector="PathIcon.nav-icon">
            <Setter Property="Width" Value="22" />
            <Setter Property="Height" Value="22" />
            <Setter Property="Foreground" Value="#FFFFFF" />
        </Style>

        <Style Selector="Button.nav-button.selected PathIcon.nav-icon">
            <Setter Property="Foreground" Value="#FFFFFF" />
        </Style>

        <Style Selector="Button.nav-button:pointerover PathIcon.nav-icon">
            <Setter Property="Foreground" Value="#FFFFFF" />
        </Style>
    </UserControl.Styles>

    <Border Background="#252525"
            BorderBrush="#1A1A1A"
            BorderThickness="0"
            CornerRadius="12"
            Margin="5"
            ClipToBounds="True">

        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Logo Section -->
            <Border Grid.Row="0"
                    Height="60"
                    Padding="0,8"
                    Margin="0,8,0,0">
                <Viewbox Width="36"
                         Height="36"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center">
                    <Panel Width="256"
                           Height="256">
                        <Image Source="/Assets/Branding/Logos/logo_256x256.png"
                               Stretch="Uniform" />
                    </Panel>
                </Viewbox>
            </Border>

            <!-- Regular Menu Items -->
            <StackPanel Grid.Row="1"
                        VerticalAlignment="Top"
                        Margin="0,12,0,0"
                        Spacing="0">
                <ItemsControl ItemsSource="{Binding MenuItems}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Spacing="0" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="models:NavigationMenuItem">
                            <Button Classes="nav-button"
                                    Classes.selected="{Binding IsSelected}"
                                    Command="{Binding $parent[UserControl].((vm:NavigationSidebarViewModel)DataContext).NavigateCommand}"
                                    CommandParameter="{Binding}"
                                    ToolTip.Tip="{Binding TooltipText}"
                                    IsVisible="{Binding !Type}">
                                <Panel>
                                    <PathIcon Classes="nav-icon"
                                              Data="{StaticResource HomeIconData}"
                                              IsVisible="{Binding Id, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=home}" />
                                    <PathIcon Classes="nav-icon"
                                              Data="{StaticResource ChatsIconData}"
                                              IsVisible="{Binding Id, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=chats}" />
                                </Panel>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- Bottom Menu Items (Settings) -->
            <StackPanel Grid.Row="2"
                        VerticalAlignment="Bottom"
                        Margin="0,0,0,12"
                        Spacing="0">
                <ItemsControl ItemsSource="{Binding MenuItems}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Spacing="0" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="models:NavigationMenuItem">
                            <Button Classes="nav-button"
                                    Classes.selected="{Binding IsSelected}"
                                    Command="{Binding $parent[UserControl].((vm:NavigationSidebarViewModel)DataContext).NavigateCommand}"
                                    CommandParameter="{Binding}"
                                    ToolTip.Tip="{Binding TooltipText}"
                                    IsVisible="{Binding Type}">
                                <PathIcon Classes="nav-icon"
                                          Data="{StaticResource SettingsIconData}"
                                          IsVisible="{Binding Id, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=settings}" />
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>
