<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="clr-namespace:Ecliptix.Core.Features.Chats.Models"
             mc:Ignorable="d"
             d:DesignWidth="600"
             d:DesignHeight="100"
             x:DataType="models:ChatMessage"
             x:Class="Ecliptix.Core.Features.Chats.Views.Components.MessageBubble">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceInclude Source="/Assets/Icons/Chat/CheckIcon.axaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="8,4">
        <!-- Sent messages (right-aligned) -->
        <StackPanel MaxWidth="450"
                    Spacing="4"
                    HorizontalAlignment="Right"
                    IsVisible="{Binding IsSent}">
            <Border CornerRadius="12"
                    Background="#FF7A00"
                    Padding="12,8"
                    MaxWidth="450">
                <StackPanel Spacing="4">
                    <TextBlock Text="{Binding Content}"
                               FontSize="14"
                               Foreground="#FFFFFF"
                               TextWrapping="Wrap" />

                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock Grid.Column="0"
                                   Text="{Binding Timestamp, StringFormat='{}{0:HH:mm}'}"
                                   FontSize="11"
                                   Foreground="#CCCCCC"
                                   HorizontalAlignment="Right" />

                        <PathIcon Grid.Column="1"
                                  Data="{StaticResource CheckIconData}"
                                  Width="14"
                                  Height="14"
                                  Foreground="#4CAF50"
                                  Margin="4,0,0,0"
                                  IsVisible="{Binding IsRead}" />
                        <PathIcon Grid.Column="1"
                                  Data="{StaticResource CheckIconData}"
                                  Width="14"
                                  Height="14"
                                  Foreground="#999999"
                                  Margin="4,0,0,0"
                                  IsVisible="{Binding !IsRead}" />
                    </Grid>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Received messages (left-aligned) -->
        <StackPanel MaxWidth="450"
                    Spacing="4"
                    HorizontalAlignment="Left"
                    IsVisible="{Binding !IsSent}">
            <TextBlock Text="{Binding SenderName}"
                       FontSize="12"
                       FontWeight="SemiBold"
                       Foreground="#999999"
                       Margin="12,0,0,0" />

            <Border CornerRadius="12"
                    Background="#2E2E2E"
                    Padding="12,8"
                    MaxWidth="450">
                <StackPanel Spacing="4">
                    <TextBlock Text="{Binding Content}"
                               FontSize="14"
                               Foreground="#FFFFFF"
                               TextWrapping="Wrap" />

                    <TextBlock Text="{Binding Timestamp, StringFormat='{}{0:HH:mm}'}"
                               FontSize="11"
                               Foreground="#CCCCCC"
                               HorizontalAlignment="Right" />
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>
</UserControl>
