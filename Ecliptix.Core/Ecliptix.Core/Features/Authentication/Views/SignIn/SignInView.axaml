<UserControl xmlns="https://github.com/avaloniaui"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:controls="clr-namespace:Ecliptix.Core.Controls"
                 xmlns:coreControls="clr-namespace:Ecliptix.Core.Controls.Core"
                 xmlns:system="clr-namespace:System;assembly=System.Runtime"
                 xmlns:global="clr-namespace:"
                 xmlns:signIn="clr-namespace:Ecliptix.Core.Features.Authentication.ViewModels.SignIn"
                 mc:Ignorable="d"
                 d:DesignWidth="320"
                 d:DesignHeight="400"
                 x:DataType="signIn:SignInViewModel"
                 x:Class="Ecliptix.Core.Features.Authentication.Views.SignIn.SignInView"
                 MinWidth="320"
                 Width="320">

        <!-- All resources moved to shared Core styles -->

        <UserControl.Styles>
            <!-- Base Button Style -->
            <Style Selector="Button.auth-button">
                <Setter Property="Height" Value="{StaticResource ButtonHeight}" />
                <Setter Property="FontWeight" Value="Medium" />
                <Setter Property="FontSize" Value="{StaticResource ButtonFontSize}" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="CornerRadius" Value="{StaticResource ButtonCornerRadius}" />
                <Setter Property="Cursor" Value="Hand" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="Transitions">
                    <Transitions>
                        <BrushTransition Property="Background" Duration="{StaticResource ButtonTransitionDuration}"
                                         Easing="CubicEaseOut" />
                        <DoubleTransition Property="Opacity" Duration="{StaticResource ButtonTransitionDuration}"
                                          Easing="CubicEaseOut" />
                    </Transitions>
                </Setter>
            </Style>

            <Style Selector="Button.auth-button:pressed">
                <Setter Property="Opacity" Value="0.9" />
            </Style>

            <!-- Recovery Button (Light Gray) -->
            <Style Selector="Button.recovery-button">
                <Setter Property="Background" Value="{DynamicResource BackButtonBackgroundColor}" />
                <Setter Property="Foreground" Value="{DynamicResource LightButtonForegroundColor}" />
            </Style>

            <Style Selector="Button.recovery-button:pointerover">
                <Setter Property="Background" Value="{StaticResource GrayButtonHoverColor}" />
            </Style>

            <Style Selector="Button.recovery-button:pressed">
                <Setter Property="Background" Value="{StaticResource GrayButtonPressedColor}" />
            </Style>

            <!-- Continue Button (Dark) -->
            <Style Selector="Button.continue-button">
                <Setter Property="Background" Value="{DynamicResource DarkButtonColor}" />
                <Setter Property="Foreground" Value="{DynamicResource DarkButtonForegroundColor}" />
            </Style>

            <Style Selector="Button.continue-button:pointerover">
                <Setter Property="Background" Value="{StaticResource DarkButtonHoverColor}" />
            </Style>

            <Style Selector="Button.continue-button:pressed">
                <Setter Property="Background" Value="{StaticResource DarkButtonPressedColor}" />
            </Style>
            
            <Style Selector="TextBlock.server-error">
                <Setter Property="FontSize" Value="{StaticResource ErrorFontSize}" />
                <Setter Property="Foreground" Value="{DynamicResource ErrorTextColor}" />
                <Setter Property="TextWrapping" Value="Wrap" />
                <Setter Property="HorizontalAlignment" Value="Stretch" />
            </Style>
        </UserControl.Styles>

        <!-- Main Layout -->
        <Grid VerticalAlignment="Top"
              RowSpacing="{StaticResource Spacing.XL}"
              RowDefinitions="Auto,Auto,Auto,Auto,Auto"
              HorizontalAlignment="Stretch"
              Width="{StaticResource Content.MaxWidth}">

            <!-- Header Section -->
            <StackPanel Grid.Row="0"
                        Spacing="{StaticResource HeaderSpacing}"
                        MaxWidth="{StaticResource HeaderMaxWidth}"
                        HorizontalAlignment="Left">
                <TextBlock Text="{Binding LocalizationService[Authentication.SignIn.Title]}"
                           FontSize="{StaticResource SubtitleFontSize}"
                           FontWeight="Light"
                           Foreground="{DynamicResource TextForegroundColor}"
                           LineHeight="28" />
                <TextBlock Text="{Binding LocalizationService[Authentication.SignIn.Welcome]}"
                           TextWrapping="Wrap"
                           FontSize="{StaticResource TitleFontSize}"
                           LineHeight="28"
                           FontWeight="Normal"
                           Foreground="{DynamicResource TextForegroundColor}"
                           Opacity="0.8" />
            </StackPanel>

            <!-- Mobile Number Input -->
            <coreControls:HintedTextBox
                Grid.Row="1"
                x:Name="MobileTextBox"
                Watermark="{Binding LocalizationService[Authentication.SignIn.MobilePlaceholder]}"
                Hint="{Binding LocalizationService[Authentication.SignIn.MobileHint]}"
                TextForeground="{DynamicResource TextBoxForegroundColor}"
                HintForeground="{DynamicResource TipsColor}"
                MainBorderBrush="Transparent"
                ErrorText="{Binding MobileNumberError, Mode=OneWay}"
                HasError="{Binding HasMobileNumberError, Mode=OneWay}"
                Text="{Binding MobileNumber, Mode=TwoWay}"
                Height="{StaticResource InputHeight}"
                CornerRadius="{StaticResource InputCornerRadius}"
                FontSize="{StaticResource InputFontSize}"
                WatermarkFontSize="{StaticResource WatermarkFontSize}"
                Background="{DynamicResource TextBoxBackgroundColor}"
                FontWeight="Light"
                HorizontalAlignment="Stretch"
                IsEnabled="{Binding !IsBusy}"/>

            <!-- SecureKey Input -->
            <coreControls:HintedTextBox
                Grid.Row="2"
                x:Name="SecureKeyTextBox"
                IsSecureKeyMode="True"
                Background="{DynamicResource TextBoxBackgroundColor}"
                Watermark="{Binding LocalizationService[Authentication.SignIn.PasswordPlaceholder]}"
                Hint="{Binding LocalizationService[Authentication.SignIn.PasswordHint]}"
                CornerRadius="{StaticResource InputCornerRadius}"
                TextForeground="{DynamicResource TextBoxForegroundColor}"
                HintForeground="{DynamicResource TipsColor}"
                MainBorderBrush="Transparent"
                FontSize="{StaticResource InputFontSize}"
                WatermarkFontSize="{StaticResource WatermarkFontSize}"
                ErrorText="{Binding SecureKeyError, Mode=OneWay}"
                HasError="{Binding HasSecureKeyError, Mode=OneWay}"
                Height="{StaticResource InputHeight}"
                FontWeight="Light"
                HorizontalAlignment="Stretch"
                MaxLength="28"
                IsEnabled="{Binding !IsBusy}"/>

            <!-- Action Buttons -->
            <Grid Grid.Row="3"
                  HorizontalAlignment="Stretch"
                  ColumnDefinitions="*,*"
                  ColumnSpacing="{StaticResource ButtonSpacing}">
                <Button Grid.Column="0"
                        Content="{Binding LocalizationService[Authentication.SignIn.AccountRecovery]}"
                        Command="{Binding AccountRecoveryCommand}"
                        IsEnabled="{Binding !IsBusy}"
                        Classes="auth-button recovery-button" />

                <Button Grid.Column="1"
                        Content="{Binding LocalizationService[Authentication.SignIn.Continue]}"
                        Command="{Binding SignInCommand}"
                        IsEnabled="{Binding SignInCommand.CanExecute}"
                        Classes="auth-button continue-button" />
            </Grid>
            
            <Border Grid.Row="4"
                    Background="Transparent"
                    HorizontalAlignment="Stretch"
                    CornerRadius="8"
                    IsVisible="{Binding HasServerError, Mode=OneWay}"
                    ClipToBounds="True"
                    Margin="8">
                    <TextBlock Grid.Column="1"
                               Text="{Binding ServerError, Mode=OneWay}"
                               Classes="server-error"
                               TextAlignment="Center"
                               VerticalAlignment="Center"
                               TextWrapping="WrapWithOverflow"
                               Foreground="{StaticResource ErrorForegroundColor}"/>
            </Border>
        </Grid>
    </UserControl>